# Simple 2D Shoot'em Up

## What's shmup?
- [shmup](https://en.wikipedia.org/wiki/Shoot_%27em_up)

## Build 
- For Windows: MSVC 2022
    ```cmd
    cmake -DCMAKE_EXPORT_COMPILE_COMMANDS:BOOL=TRUE --no-warn-unused-cli -SC:/source/sdl-shmup -Bc:/source/sdl-shmup/build -G "Visual Studio 17 2022" -T host=x86 -A win32
    ```
- For macOS: XCode 15
    ```cmd
    sh scripts/build-macos.sh
    ```

## 구현
- 레이어화 (배경 및 배경에 뿌려지는 별, 플레이어 비행체, 총알, 적)
- 적, 총알 스폰 매니징
- 랜덤으로 배경에 별 렌더링
- 메인 이벤트 루프
  - 입력 이벤트 처리
  - 충돌 판정
- 리소스: 비행체, 총알, 적, 별

## 레이어 렌더링
- 화면에 그려지는 순서를 레이어로 나눠서 최대한 드로우콜을 줄여야 함
- 메인 루프의 이벤트 처리 후 그리는 순서가 곧 레이어가 나뉘게 되는 것
1. 백그라운드 렌더링
    - 우주 스타일 (검은 색으로 채우기)
    - 배경에 뿌려지는 별 (하얀 색 별 - 텍스처 사용하지 않고 가능한가?)
        - 플레이어가 아래에서 위로 비행하는 느낌을 주기 위해 별은 위에서 아래 방향으로 움직임
        - 별 생성과 스폰 위치는 스타 스폰 매니저가 관리하며, 마지막으로 이동하면 그리지 않고 일정 시간이 지난 뒤 다시 생성
            - 스타 스폰 매니저는 플레이어의 위치를 알 필요가 없음
        - 매 프레임마다 위에서 아래 방향으로 랜덤한 속도로 움직여야 함
        - (심화) 게임 실행 시 모양과 크기를 랜덤으로 N개 생성
2. 플레이어 및 총알 렌더링
    - 플레이어는 좌/우로만 움직임
    - 플레이어의 위치는 이벤트 처리 과정에서 결정됨
    - 총알이 생성되는 위치인 총구는 플레이어 위치에 상대적
    - 총알 생성과 스폰 위치는 총알 스폰 매니저가 관리
        - 총알 스폰 매니저는 총구의 위치를 바탕으로 생성
    - (심화) 총알이 발사되거나 적과 충돌하면 발생하는 이펙트 추가
3. 적 렌더링
    - 적은 랜덤한 위치에 생성되어 위에서 아래로 이동
    - 플레이어의 총알에 부딪히면 (충돌 판정) 파괴
    - 적 생성과 스폰 위치는 적 스폰 매니저가 관리
    - (심화) 적중하면 발생하는 이펙트 추가

## 이벤트 루프 
1. 충돌 판정
    - 플레이어 <-> 적
    - 총알 <-> 적
2. 입력 이벤트 처리
    - 플레이어 이동
3. 스폰 진행
    - 별, 적, 총알
    - 각 스폰 매니저가 생성을 담당 
4. 렌더링 
    - 레이어화된대로 배경 및 별 -> 플레이어 및 총알 -> 적 순서대로 렌더링

### 충돌 판정
- 충돌 판정을 빠르게 하는 방법은? 매 이벤트 루프마다 계산해야 하기 때문에 빠르게 처리해야 함
  - `플레이어 <-> 적`는 1:N
  - `총알 <-> 적`는 N:M
- 충돌 판정의 바운드를 결정하기 위해 `서클 콜라이더`를 고안: 두 중심 좌표 점과 두 콜라이더의 반지름의 합에 의해 충돌 판정 가능

## Todo
1. 프레임 스킵
2. 콜라이더 렌더링
3. 화면 확대 축소 - 일정한 비율로 텍스처 확대 축소
4. 다양한 이펙트
5. 백그라운드 실감 나게 (소행성, 은하계 등)
6. 데이터 기반 게임 플레이 적용하는 방법 모색해볼 것

## 추가 조건
1. STL 사용 최소화
2. 알 수 없는 이유의 inline 사용 줄이기
3. 필요없는 코드는 만들지 말것
4. 가급적 ANSI 규약을 쓸것
5. SDL 함수 사용 최소화
6. frame skip도 대응
7. std::unique_ptr 사용 금지
